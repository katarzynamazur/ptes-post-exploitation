#!/bin/bash

#
# PTES 3.1.6
# Enumerate cached and static ARP table entries, which can reveal other hosts that interact with the compromised machine. Static ARP entries may represent critical machines. If the scope of the assessment allows for intercepting and modifying ARP entries, it is simple to show the possibility of disrupting, monitoring, or compromising a service in a manner that is usually not detected or protected against.
# 

exists()
{
  command -v "$1" >/dev/null 2>&1
}

print_newline()
{
    for i in {0..80}
    do
        echo -ne "\e[00;90m#"
    done
    echo "" 
}

output=$1
print_newline > $output  
###############################################################################################
if [ $# -eq 0 ]
  then
    echo "No arguments supplied"
    exit 1
fi
###############################################################################################
if exists arp; then
  arp1=`arp -a`
    echo -e "\e[00;31m[-] ARP details:\e[00m\n$arp1"  >> $output 
    print_newline >> $output  
else
  echo 'Your OS does not have arp'
fi
###############################################################################################
cat $output
