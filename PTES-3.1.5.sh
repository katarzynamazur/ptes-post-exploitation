#!/bin/bash

#
# PTES 3.1.5
# Identify network and application level proxy servers. Proxy servers make good targets when in enterprise-wide use by the client. In the case of application proxies, it may be possible to identify, modify and/or monitor the flow of traffic, or the traffic itself. Proxy attacks are often an effective means to show impact and risk to the customer.
# 

exists()
{
  command -v "$1" >/dev/null 2>&1
}

print_newline()
{
    for i in {0..80}
    do
        echo -ne "\e[00;90m#"
    done
    echo "" 
}

proxy_check()
{
    proxyhttp=`echo "$http_proxy"`
    if [ "$proxyhttp" ]; then
        echo -e "\e[00;31m[-] HTTP proxy:\e[00m\n$proxyhttp"  >> $output
    fi
    proxyhttps=`echo "$http_proxy"`
    if [ "$proxyhttps" ]; then
        echo -e "\e[00;31m[-] HTTPs proxy:\e[00m\n$proxyhttps"  >> $output
    fi
}

ptes315()
{
    proxy_check
}

if [ $# -eq 0 ]
    then
        echo "No arguments supplied"
        exit 1
fi

output=$1
print_newline > $output     
ptes315
cat $output
